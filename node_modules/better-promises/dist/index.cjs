"use strict";var Y=Object.defineProperty;var $=(n,r,e)=>r in n?Y(n,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[r]=e;var y=(n,r,e)=>$(n,typeof r!="symbol"?r+"":r,e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function k(n){return r=>r instanceof n}function M(n,r){r||(r=[]);class e extends Error{constructor(...o){const s=typeof r=="function"?r(...o):typeof r=="string"?[r]:r||[];super(...s),this.name=n}}return Object.defineProperty(e,"name",{value:n}),[e,k(e)]}const[x,q]=M("CancelledError","Promise was canceled"),[B,z]=M("TimeoutError",(n,r)=>[`Timeout reached: ${n}ms`,{cause:r}]),D=Symbol("Resolved");function T(n){return Array.isArray(n)&&n[0]===D}function G(n){return[D,n]}function P(n,r){return n.reject=r.reject,n.abort=r.abort,n}class b extends Promise{constructor(e,c){let o,s;super((a,i)=>{let d,l;typeof e=="function"?(d=e,l=c):l=e;const m=[],g=t=>(...h)=>{const p=t(...h);return m.forEach(V=>V()),p},j=new AbortController,{signal:u}=j;s=t=>{!u.aborted&&j.abort(t)};const v=()=>u.reason,w=t=>{const h=()=>{t(v())};u.addEventListener("abort",h,!0);const p=()=>{u.removeEventListener("abort",h,!0)};return m.push(p),p},F=g(t=>{a(t),s(G(t))});o=g(t=>{i(t),s(t)}),l||(l={});const{abortSignal:f,rejectOnAbort:A=!0}=l;if(f)if(f.aborted){const{reason:t}=f;if(A)return o(t);s(t)}else{const t=()=>{s(f.reason)};f.addEventListener("abort",t),m.push(()=>{f.removeEventListener("abort",t)})}A&&w(i);const{timeout:R}=l;if(R){const t=setTimeout(()=>{s(new B(R))},R);m.push(()=>{clearTimeout(t)})}const C=()=>u.aborted,S=()=>T(v()),L=()=>{const t=v();return T(t)?t[1]:void 0};try{const t=d&&d(F,o,{abortReason:v,abortSignal:u,isAborted:C,isResolved:S,onAborted:w,onResolved:h=>w(()=>{S()&&h(L())}),resolved:L,throwIfAborted(){if(C())throw v()}});t instanceof Promise&&t.catch(o)}catch(t){o(t)}});y(this,"abort");y(this,"reject");this.abort=s,this.reject=o}static fn(e,c){return new b(async(o,s,a)=>{try{o(await e(a))}catch(i){s(i)}},c)}static resolve(e){return this.fn(()=>e)}static reject(e){return new b((c,o)=>{o(e)})}cancel(){this.abort(new x)}catch(e){return this.then(void 0,e)}finally(e){return P(super.finally(e),this)}then(e,c){return P(super.then(e,c),this)}}function I(n,r){return n.resolve=r.resolve,n}class E extends b{constructor(e,c){let o,s;typeof e=="function"?(o=e,s=c):s=e;let a;super((i,d,l)=>{a=i,o&&o(i,d,l)},s);y(this,"resolve");this.resolve=a}static fn(e,c){return new E((o,s,a)=>{try{Promise.resolve(e(a)).then(o,s)}catch(i){s(i)}},c)}static resolve(e){return this.fn(()=>e)}static reject(e){return new E((c,o)=>{o(e)})}catch(e){return this.then(void 0,e)}finally(e){return I(super.finally(e),this)}then(e,c){return I(super.then(e,c),this)}}exports.AbortablePromise=b;exports.CancelledError=x;exports.ManualPromise=E;exports.TimeoutError=B;exports.isCancelledError=q;exports.isPromiseResolveResult=T;exports.isTimeoutError=z;
//# sourceMappingURL=index.cjs.map
