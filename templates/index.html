<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>FCK FSH - SPA Telegram Mini App</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">

    <!-- Подключение стилей -->
    <link rel="stylesheet" href="/static/css/global.css">
    <link rel="stylesheet" href="/static/css/loading.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/unsupported.css">
    <link rel="stylesheet" href="/static/css/footer.css">
    <link rel="stylesheet" href="/static/css/menu.css">
    <link rel="stylesheet" href="/static/css/friends.css">
    <link rel="stylesheet" href="/static/css/settings.css">
    <link rel="stylesheet" href="/static/css/news.css">
    <link rel="stylesheet" href="/static/css/brand.css">
</head>
<body>
    <div id="app">
        <div id="screen-loading"></div>
        <div id="screen-main"></div>
        <div id="screen-friends"></div>
        <div id="screen-menu"></div>
        <div id="screen-news"></div>
        <div id="screen-brand"></div>
    </div>
    <div id="footer-container" style="display: none;"></div>

    <!-- Подключение Telegram Web Apps API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const tg = window.Telegram.WebApp;
            tg.ready(); // Ждем, пока API загрузится

            function requestFullscreen() {
                if (tg.isExpanded) {
                    console.log("Приложение уже расширено.");
                } else {
                    console.log("Запрос на раскрытие...");
                    tg.expand();
                }

                if (!tg.isFullscreen) {
                    console.log("Запрос на полноэкранный режим...");
                    tg.requestFullscreen();
                }
            }

            // Ждем стабилизации viewport перед вызовом expand() и requestFullscreen()
            function checkViewport() {
                if (tg.viewportStableHeight && tg.isExpanded) {
                    console.log("Viewport стабилизирован. Разворачиваем...");
                    requestFullscreen();
                } else {
                    console.log("Ожидание стабилизации viewport...");
                    setTimeout(checkViewport, 100);
                }
            }

            setTimeout(checkViewport, 100);

            // Блокировка свайпов и жестов
            document.addEventListener("touchmove", function(event) {
                event.preventDefault();
            }, { passive: false });

            document.addEventListener("gesturestart", function(event) {
                event.preventDefault();
            });

            // Отключение закрытия по свайпу вниз в Telegram Web Apps
            tg.disableClosingConfirmation();
        });
    </script>
    <script src="/static/js/spa.js"></script>
</body>
</html>